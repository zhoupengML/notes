
* 空间域图像增强

** 微分定义

*** 一元函数

    1. 一阶微分
       
       $\frac{\partial{f}}{\partial{x}}=f(x+1)-f(x)$

    2. 二阶微分
       
       $\frac{\partial^2{f}}{\partial{x^2}}=f(x+1)+f(x-1)-2f(x)$

    
** 锐化空间滤波器

*** 一阶微分与二阶微分比较

    1. 一阶微分通常会产生较宽的边缘
    2. 二阶微分处理对细节有较强的响应,如细线和孤立点
    3. 一阶微分处理一般对灰度阶梯有较强的响应
    4. 二阶微分处理对灰度阶梯变化产生双响应
    5. 二阶微分在图像中灰度值变化相似时,对线的响应要比对阶梯强,且点比线响应强

       [[./picture/dip3.38.png]]
       
    - 大多数应用中,对图像增强来说,二阶微分处理比一阶微分好一些,因为形成增强细节的能力好一些.

*** 拉普拉斯算子(基于二阶微分的图像增强)

**** 拉普拉斯变换的作用

     - 拉普拉斯变换在图像细节的增强处理方面有明显的优点
     - 但拉普拉斯变换与梯度变换相比会产生更多的噪声,其中位于平滑区域内的噪声非常显眼

****    1. 定义[2p100]:
       最简单的各向同性微分算子是拉普拉斯算子,一个二元图像函数 $f(x,y)$ 的拉普拉斯变换定义为:
       $\nabla^2f=\frac{\partial^2f}{\partial{}x^2}+\frac{\partial^2f}{\partial{}y^2}$
       因为任意阶微分都是线性操作,所以拉普拉斯变换也是一个线性操作.

****    2. 对数字图像

       * 在 $x$ 方向上:
	 $\frac{\partial^2f}{\partial{}x^2}=f(x+1,y)+f(x-1,y)-2f(x,y)$

       * 在 $y$ 方向上:
	 $\frac{\partial^2f}{\partial{}y^2}=f(x,y+1)+f(x,y-1)-2f(x,y)$

       * 二位拉普拉斯数字实现
	 $\nabla^2f=f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)$

****    3. 滤波器掩码
              
       [[./picture/dip3.39.jpg]]
       - 对角线方向也可以加入到离散拉普拉斯变换的定义中
       - 经包含有对角分量的掩码进行处理得到的结果一般比用基本掩码处理得到的结果更加锐化

****    4. 拉普拉斯是一种微分算子,它的应用强调图像中灰度的突变以及降低灰度变化慢的区域.
       将原始图像和拉普拉斯图像叠加在一起,可以保护拉普拉斯锐化处理的效果,同时又能复原
       背景信息.
       
       \begin{eqnarray}
       g(x,y)=
       \begin{cases}
       f(x,y)-\nabla^2f(x,y)\ \ if\ the\ parameter\ in\ the\ center\ is\ negative\\
       f(x,y)+\nabla^2f(x,y)\ \ if\ the\ parameter\ in\ the\ center\ is\ positive
       \end{cases}
       \end{eqnarray}

****    5. 简化
       
       * 实际应用中,采用单一掩码的一次扫描来实现:
	 
         \begin{eqnarray}
         g(x,y)&=&f(x,y)-\nabla^2f\\
         &=&5f(x,y)-[f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)]
         \end{eqnarray}
  
       * Mask

         |----+----+----|  
         |  0 | -1 |  0 |
         |----+----+----|
         | -1 |  5 | -1 |
         |----+----+----|
         |  0 | -1 |  0 |
         |----+----+----|
    
         |----+----+----|
         | -1 | -1 | -1 |
         |----+----+----|
         | -1 |  9 | -1 |
         |----+----+----|
         | -1 | -1 | -1 |
         |----+----+----|

       * 由于拉普拉斯变换是线性算子,可以将简化掩码矩阵看做单位中心掩码矩阵减去拉普拉斯掩码矩阵

*** 梯度法(基于一阶微分的图像增强)

**** 梯度处理的作用

     - 梯度处理能用来突出图像中的小缺陷
     - 并能去除变化缓慢的背景
       
**** 函数的梯度

     1. 对于函数 $f(x,y)$ ,在其坐标 $(x,y)$ 上的梯度是通过一个二维列向量来定义的:
	\begin{eqnarray}
	\nabla{f}=
	\begin{bmatrix}
	G_x\\G_y
	\end{bmatrix}=
	\begin{bmatrix}
	\frac{\partial{f}}{\partial{x}}\\
	\frac{\partial{f}}{\partial{y}}
	\end{bmatrix}
	\end{eqnarray}
	
	这个向量的模值为:
	\begin{eqnarray}
	\|\nabla{f}\|&=&mag(\nabla{f})\\
	&=&[G_x^2+G_y^2]^{\frac{1}{2}}\\
	&=&[(\frac{\partial{f}}{\partial{x}})^2+(\frac{\partial{f}}{\partial{y}})^2]^{\frac{1}{2}}
	\end{eqnarray}

     2. 我们一般把梯度矢量的模值称为梯度,对整幅图像计算梯度运算量很大,因此,在实际操作中,常用绝对值代替平方根运算近似
	求梯度的模值:
	$\nabla{f}\approx\|G_x\|+\|G_y\|$
	
**** Roberts 交叉梯度算子[2p105]

     - 图像 $3\times3$ 区域:
       
       | $z_1$ | $z_2$ | $z_3$ |

       | $z_4$ | $z_5$ | $z_6$ |

       | $z_7$ | $z_8$ | $z_9$ |
       
       $z_5$ 处的梯度:
       $G_x=(z_9-z_5),G_y=(z_8-z_6)$
       
       $\nabla{f}\approx\|z_9-z_5\|+\|z_8-z_6\|$

**** Sobel 算子
     - 偶数尺寸的掩码并不好用,我们感兴趣的是尺寸为 $3\times{3}$ 的最小滤波器掩码,在点 $z_5$
       处,使用绝对值并使用 $3\times3$ 掩码的近似结果为:
       
       $\nabla{f}\approx\|(z_7+2z_8+z_9)-(z_1+2z_2+z_3)\|+\|(z_3+2z_6+z_9)-(z_1+2z_4+z_7)\|$

     - Sobel 掩码
       $x$ 方向:

       | -1 | -2 | -1 |

       |  0 |  0 |  0 |

       |  1 |  2 |  1 |
       
       $y$ 方向:
       
       | -1 | 0 | 1 |

       | -2 | 0 | 2 |

       | -1 | 0 | 1 |

     - 使用权重2的思想是:通过突出中心点的作用而达到平滑的目的

*** 混合空间增强法

**** 拉普拉斯变换与梯度变换对比

     - 拉普拉斯变换在图像细节的增强处理方面有明显的优点
     - 但拉普拉斯变换与梯度变换相比会产生更多的噪声,其中位于平滑区域内的噪声非常显眼
     - 梯度变换在灰度变化的区域(灰度斜坡或阶梯)的响应要比拉普拉斯变换更为强烈
     - 梯度变换对噪声和小细节的响应要比拉普拉斯变换弱,而且可以通过均值滤波器对其进行平滑处理进一步降低

     - 对梯度图像进行平滑处理并用拉普拉斯图像与它相乘,处理后的结果在灰度变化强的区域仍然保留细节,而在
       灰度变化相对平坦的区域减少噪声
     - 这种处理可以看成将拉普拉斯变换与梯度变换的优点相结合
     - 结果被加到原始图像上就可以得到最终的锐化图像
     
**** 人体骨骼扫描图增强[2p108]

     - 首先用拉普拉斯变换突出图像中的小细节
     - 然后用梯度法突出其边缘
     - 最后,通过灰度变换来扩展图像的灰度动态范围
     
       


